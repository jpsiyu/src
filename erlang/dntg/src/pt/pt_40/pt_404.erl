%% --------------------------------------------------------
%% @Module:           |pt_404
%% @Author:           |Wu Zhenhua
%% @Email:            |45517168@qq.com
%% @Created:          |2012-00-00
%% @Description:      |帮派协议处理(游戏线)
%% --------------------------------------------------------

-module(pt_404).
-export([read/2, write/2]).
-include("record.hrl").
-include("guild.hrl").

-define(SEPARATOR_STRING, "【】").

%%%=========================================================================
%%% 协议接收解包
%%%=========================================================================

%% -----------------------------------------------------------------
%% 查询自己的帮派神兽技能
%% -----------------------------------------------------------------
read(40401, _) ->
    {ok, 40401};

%% -----------------------------------------------------------------
%% 提升自己的帮派神兽仅能
%% -----------------------------------------------------------------
read(40402, _) ->
    {ok, 40402};

%% -----------------------------------------------------------------
%% 错误处理
%% -----------------------------------------------------------------
read(_Cmd, _R) ->
    {error, no_match}.

%%%=========================================================================
%%% 协议发送打包
%%%=========================================================================

%% -----------------------------------------------------------------
%% 查询自己的帮派神兽技能
%% -----------------------------------------------------------------
write(40401, [NowTimes, DailyTimes, NowUpSkillId, NowUpSkillLv, List]) ->
    Bin = pack_40401(List),
    Data = <<NowTimes:16, DailyTimes:16, NowUpSkillId:16, NowUpSkillLv:16, Bin/binary>>,
    {ok, pt:pack(40401, Data)};

%% -----------------------------------------------------------------
%% 查询自己的帮派神兽技能
%% -----------------------------------------------------------------
write(40402, [Res]) ->
    Data = <<Res:8>>,
    {ok, pt:pack(40402, Data)};


%% -----------------------------------------------------------------
%% 升级自己的帮派神兽技能
%% -----------------------------------------------------------------
write(_Cmd, _R) ->
    {ok, pt:pack(0, <<>>)}.


%% -----------------------------------------------------------------------------
%% *****************************************************************************
%% 		 打包区_对各种内容比较复杂的协议进行打包
%% *****************************************************************************
%% -----------------------------------------------------------------------------

%% -----------------------------------------------------------------
%% 打包40401
%% -----------------------------------------------------------------
pack_40401([]) ->
    <<0:16, <<>>/binary>>;
pack_40401(List) ->
    Rlen = length(List),
    F = fun({SkillId, SkillLv}) ->
        <<SkillId:16, SkillLv:16>>
    end,
    RB = list_to_binary([F(D) || D <- List]),
    <<Rlen:16, RB/binary>>.


%% -----------------------------------------------------------------------------
%% *****************************************************************************
%% 		 代码整理区
%% *****************************************************************************
%% -----------------------------------------------------------------------------
